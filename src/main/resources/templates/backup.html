<!-- templates/signup.html -->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>회원가입</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 720px; margin: 40px auto; }
    h1 { margin-bottom: 20px; }
    form { display: grid; gap: 14px; }
    .row { display: grid; grid-template-columns: 140px 1fr; gap: 12px; align-items: center; }
    input { padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
    .hint { color: #666; font-size: 12px; }
    .error { color: #c0392b; font-size: 13px; }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    button { padding: 12px 16px; border: 0; border-radius: 10px; background: #111; color: #fff; cursor: pointer; }
    button:disabled { background: #888; cursor: not-allowed; }
  </style>
</head>
<body>
<h1>회원가입</h1>

<!-- 서버에서 모델에 signUpForm 바인딩 가정: th:object="${signUpForm}" -->
<form action="/signup" th:object="${signUpForm}" method="post" id="signupForm">
  <!-- Account.email -->
  <div class="row">
    <label for="email">이메일</label>
    <div>
      <input id="email" type="email" th:field="*{email}" placeholder="you@example.com" required />
      <div class="error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
    </div>
  </div>

  <!-- Account.password -->
  <div class="row">
    <label for="password">비밀번호</label>
    <div>
      <input id="password" type="password" th:field="*{password}" minlength="8"
             pattern="^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[^A-Za-z0-9])\S{8,}$"
             placeholder="대/소문자·숫자·특수문자 포함 8자 이상" required />
      <div class="hint">대/소문자, 숫자, 특수문자 각 1자 이상 포함</div>
      <div class="error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
    </div>
  </div>

  <!-- password 확인 (서버 DTO에 passwordConfirm 필드 권장) -->
  <div class="row">
    <label for="passwordConfirm">비밀번호 확인</label>
    <div>
      <input id="passwordConfirm" type="password" th:field="*{passwordConfirm}" required />
      <div class="error" id="pwMismatch" style="display:none;">비밀번호가 일치하지 않습니다.</div>
      <div class="error" th:if="${#fields.hasErrors('passwordConfirm')}" th:errors="*{passwordConfirm}"></div>
    </div>
  </div>

  <!-- Member.name -->
  <div class="row">
    <label for="name">이름</label>
    <div>
      <input id="name" type="text" th:field="*{name}" maxlength="50" placeholder="홍길동" required />
      <div class="error" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
    </div>
  </div>

  <!-- Member.phone -->
  <div class="row">
    <label for="phone">전화번호</label>
    <div>
      <input id="phone" type="tel" th:field="*{phone}"
             pattern="^0\d{1,2}-\d{3,4}-\d{4}$" placeholder="010-1234-5678" />
      <div class="error" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}"></div>
    </div>
  </div>

  <!-- Address (Embedded) : zipcode / city / street / detail 가정 -->
  <div class="row">
    <label>주소</label>
    <div class="grid-2">
      <input type="text" th:field="*{zipcode}" placeholder="우편번호" />
      <input type="text" th:field="*{city}" placeholder="도시" />
      <input type="text" th:field="*{street}" placeholder="도로명/번지" />
    </div>
  </div>

  <div>
    <button type="submit" id="submitBtn">가입하기</button>
  </div>
</form>

<script>
  // 클라이언트 측 간단한 비밀번호 일치 체크
  const pw = document.getElementById('password');
  const pwc = document.getElementById('passwordConfirm');
  const msg = document.getElementById('pwMismatch');
  const btn = document.getElementById('submitBtn');

  function checkPw() {
    const mismatch = pw.value && pwc.value && pw.value !== pwc.value;
    msg.style.display = mismatch ? 'block' : 'none';
    btn.disabled = mismatch;
  }
  pw.addEventListener('input', checkPw);
  pwc.addEventListener('input', checkPw);
</script>
</body>
</html>